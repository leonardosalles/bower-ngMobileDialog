!function(){"use strict";angular.module("ngMobileDialog",[]).provider("$dialog",function(){var e=this;e.multiple=!1,e.headers={},e.currentScopes={},e.$get=["$timeout","$compile","$rootScope","$controller","$injector","$q","$http","$templateCache",function(t,o,r,n,l,a,i,s){function c(e,t){this.options=e,this.modalEl=t}return c.prototype.open=function(){var l=this,i=(document.body,document.querySelector(".dialog-backdrop"));return this._loadResolves().then(function(a){var s=a.$scope=a.$scope?a.$scope:r.$new();if(s.dialogId=new Date,e.currentScopes[s.dialogId]=s,l.options.controller){var c=n(l.options.controller,a);l.modalEl.dataset.ngControllerController=l.options.controller,l.options.controllerAs&&(s[l.options.controllerAs]=c)}l.modalEl.classList.add("dialog");var d=o(l.modalEl)(s)[0];s.options=l.options;var u=l.options.backdrop===!1?!1:!0;u&&i.addEventListener("click",function(){s.resolve()}),s.resolve=function(o){delete e.currentScopes[s.dialogId],l.deferred.resolve(o),l.deferred=null,d.classList.remove("active"),t(function(){s.$destroy(),e.currentDialog=null},100)},s.$on("$destroy",function(){d.remove(),i.remove();var e=new Event("hidden.ngMobileDialog");document.dispatchEvent(e)}),s.$on("$locationChangeSuccess",function(){d.classList.remove("active")}),t(function(){d.classList.add("active"),i.classList.add("in"),l.options.escKey&&(window.onkeydown=function(e){var t=e.keyCode||e.which;27==t&&(e.preventDefault(),s.resolve())})},50)}),this.deferred=a.defer(),this.deferred.promise},c.prototype._loadResolves=function(){var e=[],t=[];return angular.forEach(this.options.resolve||[],function(o,r){t.push(r),e.push(angular.isString(o)?l.get(o):l.invoke(o))}),a.all(e).then(function(e){var o={};return angular.forEach(e,function(e,r){o[t[r]]=e}),o})},{create:function(e,t){function o(o){var r=document.createElement("div");r.classList.add("dialog-backdrop"),r.classList.add("fade");var n=document.body,l=document.createElement("div");l.innerHTML=o,l.querySelector(".modal-header > button.close")&&l.querySelector(".modal-header > button.close").dataset&&(l.querySelector(".modal-header > button.close").dataset.ngClick="resolve()");var a=l.firstChild;n.appendChild(a),n.appendChild(r);var i=new c(e,a);t(i)}if(this.multiple||!document.querySelector(".dialog")||!document.querySelector(".dialog").length){if(!e.template&&!e.templateUrl)throw new Error("Template or template url must be informed!");var r=null;return e.templateUrl&&(r=s.get(e.templateUrl))?void o(r):e.template&&!e.templateUrl?void o(e.template):void i.get(e.templateUrl,{headers:this.headers}).success(function(t){o(t),s.put(e.templateUrl,t)}).error(function(){throw new Error("Can not load dialog template from url: "+e.templateUrl)})}},multiple:this.multiple,headers:this.headers,resolve:function(t){if(e.currentScopes)for(var o in e.currentScopes)if(e.currentScopes.hasOwnProperty(o)){var r=e.currentScopes[o];r.resolve(t)}}}}]})}();
