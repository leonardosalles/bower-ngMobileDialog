!function(){"use strict";angular.module("ngMobileDialog",[]).provider("$dialog",function(){var a=this;a.multiple=!1,a.headers={},a.currentScopes={},a.$get=["$timeout","$compile","$rootScope","$controller","$injector","$q","$http","$templateCache",function(b,c,d,e,f,g,h,i){function j(a,b){this.options=a,this.modalEl=b}return j.prototype.open=function(){var f=this,h=document.body,i=document.querySelector(".dialog-backdrop");return this._loadResolves().then(function(g){var j=g.$scope=g.$scope?g.$scope:d.$new();if(j.dialogId=new Date,a.currentScopes[j.dialogId]=j,f.options.controller){e(f.options.controller,g);f.modalEl.dataset.ngControllerController=f.options.controller}f.modalEl.classList.add("dialog");var l=c(f.modalEl)(j)[0];j.options=f.options;var m=f.options.backdrop===!1?!1:!0;m&&i.addEventListener("click",function(){j.resolve()}),j.resolve=function(c){delete a.currentScopes[j.dialogId],f.deferred.resolve(c),f.deferred=null,l.classList.remove("active"),b(function(){j.$destroy(),a.currentDialog=null},100)},j.$on("$destroy",function(){l.remove(),i.remove();var a=new Event("hidden.ngMobileDialog");h.dispatchEvent(a)}),j.$on("$locationChangeSuccess",function(){l.classList.remove("active")}),b(function(){l.classList.add("active"),i.classList.add("in"),f.options.escKey&&(window.onkeydown=function(a){var b=a.keyCode||a.which;27==b&&(a.preventDefault(),j.resolve())})},50)}),this.deferred=g.defer(),this.deferred.promise},j.prototype._loadResolves=function(){var a=[],b=[];return angular.forEach(this.options.resolve||[],function(c,d){b.push(d),a.push(angular.isString(c)?f.get(c):f.invoke(c))}),g.all(a).then(function(a){var c={};return angular.forEach(a,function(a,d){c[b[d]]=a}),c})},{create:function(a,b){function d(c){var d=document.createElement("div");d.classList.add("dialog-backdrop"),d.classList.add("fade");var e=document.body,f=document.createElement("div");f.innerHTML=c,f.querySelector(".modal-header > button.close").dataset.ngClick="resolve()";var g=f.firstChild;e.appendChild(g),e.appendChild(d);var h=new j(a,g);b(h)}if(this.multiple||!document.querySelector(".dialog").length){if(!a.template&&!a.templateUrl)throw new Error("Template or template url must be informed!");var c=null;return a.templateUrl&&(c=i.get(a.templateUrl))?void d(c):a.template&&!a.templateUrl?void d(a.template):void h.get(a.templateUrl,{headers:this.headers}).success(function(b){d(b),i.put(a.templateUrl,b)}).error(function(){throw new Error("Can not load dialog template from url: "+a.templateUrl)})}},multiple:this.multiple,headers:this.headers,resolve:function(b){if(a.currentScopes)for(var c in a.currentScopes)if(a.currentScopes.hasOwnProperty(c)){var d=a.currentScopes[c];d.resolve(b)}}}}]})}();
